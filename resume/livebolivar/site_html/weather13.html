<?php
/* https://xml.weather.yahoo.com/forecastrss?p=65613&u=f
https://www.phptoys.com/tutorial/get-actual-weather.html# 
https://www.phptoys.com/download/downloadItem.php?id=28
INCLUDED ITEMS:
sunrise-sunset.php
REQUIRE_ONCE ITEMS:
weather-Current-NOAA-Weather-Grabber.php
/noaa/Forecaster.php
	FORECASTER.PHP REQUIRE_ONCE:
			require_once 'weather/Base.php';
			require_once 'weather/Configuration.php';
			require_once 'weather/response/Response.php';
			require_once 'weather/response/CurrentWeather.php';
			require_once 'weather/cache/Cache.php';
			require_once 'weather/cache/ArrayCache.php';
			require_once 'weather/cache/FileCache.php';
			require_once 'weather/cache/NoCache.php';
*/

$ts = gmdate("D, d M Y H:i:s") . " GMT";
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
header("Last-Modified: $ts");
header("Pragma: no-cache");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", FALSE);
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEATHER RADAR SPRINGFIELD,MO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" type="text/css" href="../Css/reset.css">

		<link rel="stylesheet" type="text/css" href="../Css/screen_styles.css">

		<link rel="stylesheet" type="text/css" href="../Css/screen_layout_large.css">

		<link rel="stylesheet" type="text/css" media="only screen and (min-width:50px) and (max-width:600px)" href="../Css/screen_layout_small.css">

		<link rel="stylesheet" type="text/css" media="only screen and (min-width:601px) and (max-width:800px)" href="../Css/screen_layout_medium.css">
        
        <link rel="icon" href="favicon.ico?v=1.1"> 

		<link href="images/apple-touch-icon.png" rel="apple-touch-icon">

		<link href="images/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">

		<link href="images/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">

		<link href="images/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">

		<link href="images/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180">

		<link href="images/icon-hires.png" rel="icon" sizes="192x192">

		<link href="images/icon-normal.png" rel="icon" sizes="128x128">

		<!--[if lt IE 9]>

			<script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>

		<![endif]-->
        
<script type="text/javascript" src="../files/_jquery.min.js"></script>

<script type="text/javascript" src="../files/_stickytooltip.js"></script>

    <!--* Sticky Tooltip script- (c) Dynamic Drive DHTML code library (www.dynamicdrive.com)

* This notice MUST stay intact for legal use

* Visit Dynamic Drive at https://www.dynamicdrive.com/ for this script and 100s more

***********************************************/ -->

<link rel="stylesheet" type="text/css" href="../files/_stickytooltip.css">
        
<style type="text/css">
h1 {margin: 1em 0em 1em .5em;}   
p {text-align: right; padding-right: 20px; padding-bottom: 20px}
.style1 {padding-left: 20px;color: #FFFFFF}
</style>   
       
</head>

<body>


<?php
// WIND SPEED AND DIRECTION
global $argc;
// https://github.com/amwhalen/noaa
// retrieve the station ID from the command line if supplied
if ($argc > 1) {
	$stationId = $argv[1];
} else {
$stationId = "KSGF";
}

// Instantiate a Forecaster object using a file cache
// XML data from the NOAA API will be cached for 1 HOUR in the specified file location
require_once dirname(__FILE__) . '/noaa/Forecaster.php';
$config = new \noaa\weather\Configuration();
$config->setCache(new \noaa\weather\cache\FileCache(dirname(__FILE__) . '/cache'));
$forecaster = new \noaa\Forecaster($config);

// fetch a CurrentWeather instance for a specific station ID
// find station IDs here: https://www.weather.gov/xml/current_obs/
try {
	$current = $forecaster->getCurrentWeather($stationId);
} catch (\Exception $e) {
	echo "Error: " . $e->getMessage() . "\n";
	exit(1);
}

// display
// echo $current->getLocation() . "\n";
// echo $current->getObservationTime() . "\n";
// rtrim($current->getWindString, "()")
// substr_replace($current->getWindString(), "", -5)
// trim($getWindString, "()")
?>
<div class="left">
<?php
// source https://forecast.weather.gov/MapClick.php?lat=37.6268&lon=-93.4313&unit=0&lg=english&FcstType=dwml
// Require the weather function
require_once( 'weather-Current-NOAA-Weather-Grabber.php' );
// Standard display function
function noaa_weather_grabber_test( $weather ) {
    // Display each item
    if ((isset ( $weather->okay )) && ( $weather->okay == "yes" )) {
        // echo "Weather Springfield, MO" . "\n";
        echo date("D, M jS, Y ") . "<br />\n";
        echo "TEMP: " . $weather->temp . "&deg;F" . "<br />\n";
    	echo "Conditions: " . "<br />\n";
        // echo $weather->condition . "<br />\n";
		// over 40 characters pushes the adjacent graphic down
		$text = $weather->condition;
		$newtext = wordwrap($text, 40, "<br />\n");
		echo $newtext . "<br />\n";
		include 'sunrise-sunset.php';
		echo "\n";
	}
	
	// Dump the entire weather variable
	// This is just for testing -- do not include on your website.
    // var_dump( $weather );
}

?>




<?php
// Get the weather
$weather = noaa_weather_grabber( 'KSGF', 'yes', 'https://forecast.weather.gov/MapClick.php?lat=37.6268&lon=-93.4313&unit=0&lg=english&FcstType=dwml');
// Run the weather test function
noaa_weather_grabber_test( $weather );
?>

<?php 
// GET THE WIND SPEED AND DIRECTION
// https://github.com/amwhalen/noaa  (SEE ABOVE)
echo "WIND from the: " . "<br>";
// https://stackoverflow.com/questions/5159086/php-split-string
// below delimits at the "(" (i.e. (9 KT), puts each part into a variable (list $a $b) and
// displays the first variable (echo $a)
// echo "from the southwest at 5.37 gusting to 23.7 MPH " . "<br>";
// $in ="from the southwest at 5.37 gusting to 23.7 MPH ";
// $out = strlen($in) > 26 ? substr($in,0,26) : $in;
// echo $out . "<br>";

$test ="from the southwest at 5.37 gusting to 23.7 MPH ";
list ($a , $b) = explode('(', $current->getWindString());
// echo $a  . "<br>";
// below from https://stackoverflow.com/questions/11434091/add-if-string-is-too-long-php
// $out = strlen($a) > 26 ? substr($a,9,39)  . "<br>": $a;
// $out = strlen($test) > 26 ? substr($test,9,39) . "<br>": $test;
// echo $out;

if(strlen($test) >= 26)
{
    echo substr($test, 8, 18) . "<br>"; //prints everything before 50th character
	echo substr($test, 26) . "<br>"; //prints everything after 50th character
}

if(strlen($a) >= 26)
{
    echo substr($a, 8, 18) . "<br>"; //prints everything before 50th character
	echo substr($a, 26) . "<br>"; //prints everything after 50th character
}

if(strlen($a) <= 26)
{
    echo $a. "<br>"; 
}	

// below from https://stackoverflow.com/questions/31604471/break-long-string-variable-in-multiple-lines-php
// $array = str_split($a, 26); 
// echo implode("<br>",$array)  . "<br>";
// $array = str_split($out, 26); 
// echo implode("<br>",$array)  . "<br>";

// mb_strimwidth($test, 8, 34);
// USE THE TWO FOLLOWING LINES WHEN "GUSTING" IS PRESENT
// echo substr($a, 9, 21) . "<br>";
// echo substr($a, 30, 24) . "<br>";
// below displays the first x characters (i.e. 17)
// echo substr($current->getWindString(), 0, 17) . "<br>";

?>

<a href="https://www.almanac.com/astronomy/rise/MO/Bolivar/<?php echo date('Y-m-d'); ?>" data-tooltip="almanac_com">PLANETS</a>


<div data-tooltip="moonphase" title="Moon Phase Software $10">
<a href="https://www.moonconnection.com/current_moon_phase.phtml">
<script language="JavaScript" type="text/javascript">var ccm_cfg = { pth:'https://www.moonmodule.com/cs/', fn:'ccm_v1.swf', lg:'en', hs:1, tc:'FFFFFF', bg:'000000', mc:'', fw:127, fh:227 } </script>
<script language="JavaScript" type="text/javascript" src="https://www.moonmodule.com/cs/ccm_fl.js"></script>
</a>















<div id="mystickytooltip" class="stickytooltip">

  <div style="padding:5px">
      
      <div id="email" class="atip"> <img src="email.jpg" height="322" width="353" alt=""> </div>
      
      <div id="skype" class="atip"> <img src="skype.jpg" height="322" width="353" alt=""> </div>
      
      <div id="skype2" class="atip"> <img src="skype2.jpg" height="558" width="410" alt=""> </div>
      
      <div id="aj" class="atip"> <img src="aj.jpg" height="322" width="353" alt=""> </div>
      
      <div id="banner" class="atip"> <img src="banner.jpg" height="108" width="351" alt=""> </div>
      
      <div id="office" class="atip"> <img src="../images/map_office.jpg" height="438" width="353" alt=""> </div>
      
<!--        <div id="moonphase" class="atip"> <img src="moon_phase_screenshot2.jpg" height="660" width="660" alt=""> </div> -->
	  <div id="moonphase" class="atip"> <img src="moon_phase_screenshot3.jpg" height="400" width="500" alt=""> </div>
      
     <!--<div id="moonphase" class="atip"> <img src="moonphase_software.jpg" height="550" width="500" alt=""> </div>  -->
     
     <div id="myweather" class="atip"> <img src="myweather.jpg" height="462" width="554" alt=""></div>
      
      <div id="sky_telescope_screenshot" class="atip"> <img src="sky_telescope.jpg" height="586" width="346" alt=""> </div>
      
      <div id="almanac_com" class="atip"> <img src="weather_planets_screenshot.jpg" height="350" width="300" alt=""> </div>
     
    <!--<div id="map_screenshot" class="atip"> <img src="map_screenshot6.jpg" height="322" width="525" /> </div> -->
    <div id="map_address" class="atip"> <img src="map_screenshot6.jpg" height="322" width="525" alt=""> </div>
   
   <div class="stickystatus"></div> </div>

  </div>  </div>

</body>
</html>
